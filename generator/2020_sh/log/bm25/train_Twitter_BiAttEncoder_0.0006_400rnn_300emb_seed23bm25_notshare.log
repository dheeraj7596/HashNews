[2020-09-09 00:52:51,952 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 00:52:52,091 INFO]  * vocabulary size. source = 49840; target = 8909
[2020-09-09 00:52:52,091 INFO] Building model...
[2020-09-09 00:53:04,907 INFO] TwoEncoderModel(
  (encoder): BiAttEncoder(
    (linear_bm25): Linear(in_features=1, out_features=1, bias=True)
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(49840, 300, padding_idx=0)
        )
      )
    )
    (src_rnn_list): ModuleList(
      (0): GRU(300, 200, bidirectional=True)
    )
    (merge_rnn): GRU(800, 200, bidirectional=True)
    (combine_output): Linear(in_features=800, out_features=400, bias=True)
    (combine_hidden): Linear(in_features=400, out_features=200, bias=True)
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(8909, 300, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (rnn): StackedGRU(
      (dropout): Dropout(p=0.1, inplace=False)
      (layers): ModuleList(
        (0): GRUCell(700, 400)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=400, out_features=400, bias=False)
      (linear_out): Linear(in_features=800, out_features=400, bias=False)
      (sm): Softmax(dim=-1)
      (tanh): Tanh()
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=400, out_features=8909, bias=True)
    (1): LogSoftmax()
  )
)
[2020-09-09 00:53:04,908 INFO] * number of parameters: 25205011
[2020-09-09 00:53:04,908 INFO] encoder: 17157402
[2020-09-09 00:53:04,908 INFO] decoder: 8047609
[2020-09-09 00:53:04,908 INFO] Making optimizer for training.
Stage 1: Keys after executing optim.set_parameters(model.parameters())
optim.optimizer.state_dict()['state'] keys: 
optim.optimizer.state_dict()['param_groups'] elements: 
optim.optimizer.state_dict()['param_groups'] element: {'lr': 0.0006, 'betas': [0.9, 0.999], 'eps': 1e-09, 'weight_decay': 0, 'amsgrad': False, 'params': [139625227083712, 139625227083640, 139625227083568, 139625226633360, 139625226633504, 139625226633432, 139625226633648, 139625226633792, 139625226633720, 139625226633936, 139625226634080, 139625226634512, 139625226634656, 139625226634584, 139625226634800, 139625226634944, 139625226634872, 139625226635088, 139625226635232, 139625226635664, 139625226635808, 139625226635736, 139625226635952, 139625226636096, 139625226636024, 139625226636240, 139625226636384, 139625226636312, 139625226636528, 139625226636672, 139625226636600, 139625226636816]}
/home/xiuwen/anaconda3/envs/hashtagGen/lib/python3.6/site-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
[2020-09-09 00:53:04,912 INFO] 
[2020-09-09 00:53:04,912 INFO] Start training...
[2020-09-09 00:53:04,912 INFO]  * number of epochs: 15, starting from Epoch 1
[2020-09-09 00:53:04,912 INFO]  * batch size: 64
[2020-09-09 00:53:04,912 INFO] The current epoch: 1
[2020-09-09 00:53:18,399 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 00:53:26,389 INFO] Epoch  1,    50/  769; acc:  33.29; ppl: 353.53; xent:   5.87;  6610 src tok/s; 1258 tgt tok/s;      8 s elapsed
[2020-09-09 00:53:33,912 INFO] Epoch  1,   100/  769; acc:  32.61; ppl: 184.52; xent:   5.22;  7825 src tok/s; 1397 tgt tok/s;     15 s elapsed
[2020-09-09 00:53:41,636 INFO] Epoch  1,   150/  769; acc:  33.99; ppl: 152.27; xent:   5.03;  7279 src tok/s; 1360 tgt tok/s;     23 s elapsed
[2020-09-09 00:53:48,939 INFO] Epoch  1,   200/  769; acc:  37.30; ppl: 105.90; xent:   4.66;  7547 src tok/s; 1371 tgt tok/s;     31 s elapsed
[2020-09-09 00:53:56,361 INFO] Epoch  1,   250/  769; acc:  37.88; ppl:  95.07; xent:   4.55;  7476 src tok/s; 1369 tgt tok/s;     38 s elapsed
[2020-09-09 00:54:03,865 INFO] Epoch  1,   300/  769; acc:  39.17; ppl:  84.71; xent:   4.44;  7416 src tok/s; 1382 tgt tok/s;     45 s elapsed
[2020-09-09 00:54:11,075 INFO] Epoch  1,   350/  769; acc:  41.83; ppl:  61.30; xent:   4.12;  7226 src tok/s; 1420 tgt tok/s;     53 s elapsed
[2020-09-09 00:54:19,119 INFO] Epoch  1,   400/  769; acc:  43.26; ppl:  57.01; xent:   4.04;  7231 src tok/s; 1285 tgt tok/s;     61 s elapsed
[2020-09-09 00:54:26,842 INFO] Epoch  1,   450/  769; acc:  44.12; ppl:  48.18; xent:   3.87;  7034 src tok/s; 1333 tgt tok/s;     68 s elapsed
[2020-09-09 00:54:34,076 INFO] Epoch  1,   500/  769; acc:  44.30; ppl:  53.23; xent:   3.97;  7953 src tok/s; 1428 tgt tok/s;     76 s elapsed
[2020-09-09 00:54:41,611 INFO] Epoch  1,   550/  769; acc:  46.57; ppl:  42.31; xent:   3.75;  7805 src tok/s; 1366 tgt tok/s;     83 s elapsed
[2020-09-09 00:54:48,916 INFO] Epoch  1,   600/  769; acc:  46.11; ppl:  45.14; xent:   3.81;  7115 src tok/s; 1397 tgt tok/s;     90 s elapsed
[2020-09-09 00:54:56,529 INFO] Epoch  1,   650/  769; acc:  47.46; ppl:  38.02; xent:   3.64;  7007 src tok/s; 1408 tgt tok/s;     98 s elapsed
[2020-09-09 00:55:04,453 INFO] Epoch  1,   700/  769; acc:  46.83; ppl:  38.71; xent:   3.66;  7333 src tok/s; 1240 tgt tok/s;    106 s elapsed
[2020-09-09 00:55:12,168 INFO] Epoch  1,   750/  769; acc:  47.79; ppl:  36.20; xent:   3.59;  7131 src tok/s; 1314 tgt tok/s;    114 s elapsed
[2020-09-09 00:55:15,297 INFO] Train perplexity: 70.735
[2020-09-09 00:55:15,297 INFO] Train accuracy: 41.692
[2020-09-09 00:55:16,654 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
/home/xiuwen/anaconda3/envs/hashtagGen/lib/python3.6/site-packages/torchtext/data/field.py:321: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  return Variable(arr, volatile=not train), lengths
/home/xiuwen/anaconda3/envs/hashtagGen/lib/python3.6/site-packages/torchtext/data/field.py:322: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  return Variable(arr, volatile=not train)
[2020-09-09 00:55:32,031 INFO] Validation perplexity: 37.2727
[2020-09-09 00:55:32,031 INFO] Validation accuracy: 48.8276
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_48.83_ppl_37.27_e1.pt
[2020-09-09 00:55:32,964 INFO] The current epoch: 2
[2020-09-09 00:55:48,727 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 00:55:56,871 INFO] Epoch  2,    50/  769; acc:  48.95; ppl:  28.96; xent:   3.37;  6462 src tok/s; 1230 tgt tok/s;      8 s elapsed
[2020-09-09 00:56:04,283 INFO] Epoch  2,   100/  769; acc:  49.40; ppl:  27.75; xent:   3.32;  7940 src tok/s; 1418 tgt tok/s;     16 s elapsed
[2020-09-09 00:56:12,164 INFO] Epoch  2,   150/  769; acc:  49.80; ppl:  26.01; xent:   3.26;  7135 src tok/s; 1333 tgt tok/s;     23 s elapsed
[2020-09-09 00:56:19,603 INFO] Epoch  2,   200/  769; acc:  50.45; ppl:  24.93; xent:   3.22;  7408 src tok/s; 1346 tgt tok/s;     31 s elapsed
[2020-09-09 00:56:27,021 INFO] Epoch  2,   250/  769; acc:  50.78; ppl:  23.72; xent:   3.17;  7480 src tok/s; 1370 tgt tok/s;     38 s elapsed
[2020-09-09 00:56:34,538 INFO] Epoch  2,   300/  769; acc:  50.94; ppl:  23.59; xent:   3.16;  7403 src tok/s; 1380 tgt tok/s;     46 s elapsed
[2020-09-09 00:56:41,901 INFO] Epoch  2,   350/  769; acc:  52.08; ppl:  20.97; xent:   3.04;  7075 src tok/s; 1391 tgt tok/s;     53 s elapsed
[2020-09-09 00:56:49,825 INFO] Epoch  2,   400/  769; acc:  52.44; ppl:  20.77; xent:   3.03;  7340 src tok/s; 1304 tgt tok/s;     61 s elapsed
[2020-09-09 00:56:57,469 INFO] Epoch  2,   450/  769; acc:  52.63; ppl:  19.20; xent:   2.96;  7108 src tok/s; 1347 tgt tok/s;     69 s elapsed
[2020-09-09 00:57:05,301 INFO] Epoch  2,   500/  769; acc:  51.60; ppl:  21.09; xent:   3.05;  7345 src tok/s; 1319 tgt tok/s;     77 s elapsed
[2020-09-09 00:57:13,423 INFO] Epoch  2,   550/  769; acc:  53.55; ppl:  18.35; xent:   2.91;  7241 src tok/s; 1267 tgt tok/s;     85 s elapsed
[2020-09-09 00:57:20,858 INFO] Epoch  2,   600/  769; acc:  52.33; ppl:  19.95; xent:   2.99;  6990 src tok/s; 1372 tgt tok/s;     92 s elapsed
[2020-09-09 00:57:28,555 INFO] Epoch  2,   650/  769; acc:  54.40; ppl:  17.35; xent:   2.85;  6930 src tok/s; 1392 tgt tok/s;    100 s elapsed
[2020-09-09 00:57:36,178 INFO] Epoch  2,   700/  769; acc:  52.37; ppl:  18.79; xent:   2.93;  7622 src tok/s; 1289 tgt tok/s;    107 s elapsed
[2020-09-09 00:57:44,083 INFO] Epoch  2,   750/  769; acc:  53.39; ppl:  17.86; xent:   2.88;  6960 src tok/s; 1283 tgt tok/s;    115 s elapsed
[2020-09-09 00:57:47,116 INFO] Train perplexity: 21.4783
[2020-09-09 00:57:47,116 INFO] Train accuracy: 51.7678
[2020-09-09 00:57:48,496 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 00:58:04,384 INFO] Validation perplexity: 29.2856
[2020-09-09 00:58:04,385 INFO] Validation accuracy: 51.8966
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_51.90_ppl_29.29_e2.pt
[2020-09-09 00:58:05,396 INFO] The current epoch: 3
[2020-09-09 00:58:18,709 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 00:58:26,961 INFO] Epoch  3,    50/  769; acc:  54.54; ppl:  15.26; xent:   2.73;  6378 src tok/s; 1214 tgt tok/s;      8 s elapsed
[2020-09-09 00:58:34,369 INFO] Epoch  3,   100/  769; acc:  54.59; ppl:  14.77; xent:   2.69;  7945 src tok/s; 1419 tgt tok/s;     16 s elapsed
[2020-09-09 00:58:42,298 INFO] Epoch  3,   150/  769; acc:  55.10; ppl:  14.11; xent:   2.65;  7091 src tok/s; 1324 tgt tok/s;     24 s elapsed
[2020-09-09 00:58:49,441 INFO] Epoch  3,   200/  769; acc:  55.11; ppl:  13.82; xent:   2.63;  7716 src tok/s; 1402 tgt tok/s;     31 s elapsed
[2020-09-09 00:58:57,038 INFO] Epoch  3,   250/  769; acc:  55.68; ppl:  13.09; xent:   2.57;  7303 src tok/s; 1337 tgt tok/s;     38 s elapsed
[2020-09-09 00:59:04,601 INFO] Epoch  3,   300/  769; acc:  56.26; ppl:  12.83; xent:   2.55;  7359 src tok/s; 1371 tgt tok/s;     46 s elapsed
[2020-09-09 00:59:11,976 INFO] Epoch  3,   350/  769; acc:  56.18; ppl:  12.28; xent:   2.51;  7062 src tok/s; 1388 tgt tok/s;     53 s elapsed
[2020-09-09 00:59:19,274 INFO] Epoch  3,   400/  769; acc:  56.60; ppl:  12.02; xent:   2.49;  7970 src tok/s; 1416 tgt tok/s;     61 s elapsed
[2020-09-09 00:59:26,329 INFO] Epoch  3,   450/  769; acc:  57.19; ppl:  11.40; xent:   2.43;  7702 src tok/s; 1459 tgt tok/s;     68 s elapsed
[2020-09-09 00:59:33,892 INFO] Epoch  3,   500/  769; acc:  56.76; ppl:  12.05; xent:   2.49;  7607 src tok/s; 1366 tgt tok/s;     75 s elapsed
[2020-09-09 00:59:41,511 INFO] Epoch  3,   550/  769; acc:  57.77; ppl:  10.79; xent:   2.38;  7719 src tok/s; 1351 tgt tok/s;     83 s elapsed
[2020-09-09 00:59:49,327 INFO] Epoch  3,   600/  769; acc:  56.58; ppl:  11.71; xent:   2.46;  6649 src tok/s; 1305 tgt tok/s;     91 s elapsed
[2020-09-09 00:59:57,070 INFO] Epoch  3,   650/  769; acc:  58.30; ppl:  10.33; xent:   2.33;  6889 src tok/s; 1384 tgt tok/s;     98 s elapsed
[2020-09-09 01:00:04,905 INFO] Epoch  3,   700/  769; acc:  56.19; ppl:  11.38; xent:   2.43;  7423 src tok/s; 1255 tgt tok/s;    106 s elapsed
[2020-09-09 01:00:12,354 INFO] Epoch  3,   750/  769; acc:  57.32; ppl:  10.96; xent:   2.39;  7387 src tok/s; 1361 tgt tok/s;    114 s elapsed
[2020-09-09 01:00:15,313 INFO] Train perplexity: 12.278
[2020-09-09 01:00:15,314 INFO] Train accuracy: 56.345
[2020-09-09 01:00:16,533 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 01:00:32,358 INFO] Validation perplexity: 29.9671
[2020-09-09 01:00:32,359 INFO] Validation accuracy: 52.1363
[2020-09-09 01:00:32,359 INFO] Decaying learning rate to 0.0003
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_52.14_ppl_29.97_e3.pt
[2020-09-09 01:00:33,340 INFO] The current epoch: 4
[2020-09-09 01:00:49,255 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 01:00:57,770 INFO] Epoch  4,    50/  769; acc:  58.09; ppl:   9.55; xent:   2.26;  6193 src tok/s; 1179 tgt tok/s;      9 s elapsed
[2020-09-09 01:01:06,053 INFO] Epoch  4,   100/  769; acc:  58.99; ppl:   9.15; xent:   2.21;  7107 src tok/s; 1269 tgt tok/s;     17 s elapsed
[2020-09-09 01:01:14,448 INFO] Epoch  4,   150/  769; acc:  59.41; ppl:   8.78; xent:   2.17;  6697 src tok/s; 1251 tgt tok/s;     25 s elapsed
[2020-09-09 01:01:22,337 INFO] Epoch  4,   200/  769; acc:  59.12; ppl:   8.54; xent:   2.15;  6987 src tok/s; 1269 tgt tok/s;     33 s elapsed
[2020-09-09 01:01:30,753 INFO] Epoch  4,   250/  769; acc:  60.12; ppl:   8.05; xent:   2.09;  6592 src tok/s; 1207 tgt tok/s;     41 s elapsed
[2020-09-09 01:01:38,889 INFO] Epoch  4,   300/  769; acc:  60.93; ppl:   7.76; xent:   2.05;  6841 src tok/s; 1275 tgt tok/s;     50 s elapsed
[2020-09-09 01:01:46,935 INFO] Epoch  4,   350/  769; acc:  61.05; ppl:   7.52; xent:   2.02;  6475 src tok/s; 1273 tgt tok/s;     58 s elapsed
[2020-09-09 01:01:55,055 INFO] Epoch  4,   400/  769; acc:  61.68; ppl:   7.29; xent:   1.99;  7164 src tok/s; 1273 tgt tok/s;     66 s elapsed
[2020-09-09 01:02:03,240 INFO] Epoch  4,   450/  769; acc:  61.84; ppl:   6.91; xent:   1.93;  6639 src tok/s; 1258 tgt tok/s;     74 s elapsed
[2020-09-09 01:02:11,609 INFO] Epoch  4,   500/  769; acc:  61.97; ppl:   7.18; xent:   1.97;  6874 src tok/s; 1234 tgt tok/s;     82 s elapsed
[2020-09-09 01:02:20,258 INFO] Epoch  4,   550/  769; acc:  63.17; ppl:   6.44; xent:   1.86;  6800 src tok/s; 1190 tgt tok/s;     91 s elapsed
[2020-09-09 01:02:28,350 INFO] Epoch  4,   600/  769; acc:  61.91; ppl:   6.84; xent:   1.92;  6422 src tok/s; 1261 tgt tok/s;     99 s elapsed
[2020-09-09 01:02:36,667 INFO] Epoch  4,   650/  769; acc:  64.39; ppl:   6.00; xent:   1.79;  6414 src tok/s; 1289 tgt tok/s;    107 s elapsed
[2020-09-09 01:02:44,894 INFO] Epoch  4,   700/  769; acc:  62.37; ppl:   6.47; xent:   1.87;  7064 src tok/s; 1194 tgt tok/s;    116 s elapsed
[2020-09-09 01:02:53,248 INFO] Epoch  4,   750/  769; acc:  63.42; ppl:   6.25; xent:   1.83;  6586 src tok/s; 1214 tgt tok/s;    124 s elapsed
[2020-09-09 01:02:56,640 INFO] Train perplexity: 7.39871
[2020-09-09 01:02:56,640 INFO] Train accuracy: 61.3094
[2020-09-09 01:02:57,854 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 01:03:15,649 INFO] Validation perplexity: 31.5173
[2020-09-09 01:03:15,650 INFO] Validation accuracy: 52.6521
[2020-09-09 01:03:15,650 INFO] Decaying learning rate to 0.00015
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_52.65_ppl_31.52_e4.pt
[2020-09-09 01:03:16,563 INFO] The current epoch: 5
[2020-09-09 01:03:30,230 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 01:03:39,105 INFO] Epoch  5,    50/  769; acc:  61.02; ppl:   7.14; xent:   1.97;  5932 src tok/s; 1129 tgt tok/s;      9 s elapsed
[2020-09-09 01:03:48,199 INFO] Epoch  5,   100/  769; acc:  61.96; ppl:   6.82; xent:   1.92;  6472 src tok/s; 1156 tgt tok/s;     18 s elapsed
[2020-09-09 01:03:57,298 INFO] Epoch  5,   150/  769; acc:  62.54; ppl:   6.55; xent:   1.88;  6179 src tok/s; 1154 tgt tok/s;     27 s elapsed
[2020-09-09 01:04:05,991 INFO] Epoch  5,   200/  769; acc:  62.81; ppl:   6.36; xent:   1.85;  6341 src tok/s; 1152 tgt tok/s;     36 s elapsed
[2020-09-09 01:04:15,215 INFO] Epoch  5,   250/  769; acc:  63.09; ppl:   6.03; xent:   1.80;  6015 src tok/s; 1101 tgt tok/s;     45 s elapsed
[2020-09-09 01:04:24,292 INFO] Epoch  5,   300/  769; acc:  64.35; ppl:   5.73; xent:   1.75;  6133 src tok/s; 1143 tgt tok/s;     54 s elapsed
[2020-09-09 01:04:33,559 INFO] Epoch  5,   350/  769; acc:  64.28; ppl:   5.70; xent:   1.74;  5621 src tok/s; 1105 tgt tok/s;     63 s elapsed
[2020-09-09 01:04:43,043 INFO] Epoch  5,   400/  769; acc:  65.55; ppl:   5.43; xent:   1.69;  6133 src tok/s; 1090 tgt tok/s;     73 s elapsed
[2020-09-09 01:04:52,180 INFO] Epoch  5,   450/  769; acc:  65.59; ppl:   5.14; xent:   1.64;  5947 src tok/s; 1127 tgt tok/s;     82 s elapsed
[2020-09-09 01:05:01,716 INFO] Epoch  5,   500/  769; acc:  65.85; ppl:   5.30; xent:   1.67;  6033 src tok/s; 1083 tgt tok/s;     91 s elapsed
[2020-09-09 01:05:11,189 INFO] Epoch  5,   550/  769; acc:  66.99; ppl:   4.79; xent:   1.57;  6208 src tok/s; 1086 tgt tok/s;    101 s elapsed
[2020-09-09 01:05:20,160 INFO] Epoch  5,   600/  769; acc:  66.17; ppl:   5.06; xent:   1.62;  5794 src tok/s; 1137 tgt tok/s;    110 s elapsed
[2020-09-09 01:05:29,221 INFO] Epoch  5,   650/  769; acc:  68.59; ppl:   4.48; xent:   1.50;  5887 src tok/s; 1183 tgt tok/s;    119 s elapsed
[2020-09-09 01:05:38,562 INFO] Epoch  5,   700/  769; acc:  67.22; ppl:   4.71; xent:   1.55;  6221 src tok/s; 1052 tgt tok/s;    128 s elapsed
[2020-09-09 01:05:47,724 INFO] Epoch  5,   750/  769; acc:  68.61; ppl:   4.53; xent:   1.51;  6005 src tok/s; 1107 tgt tok/s;    137 s elapsed
[2020-09-09 01:05:51,603 INFO] Train perplexity: 5.49993
[2020-09-09 01:05:51,604 INFO] Train accuracy: 65.057
[2020-09-09 01:05:55,641 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 01:06:16,046 INFO] Validation perplexity: 32.8595
[2020-09-09 01:06:16,048 INFO] Validation accuracy: 52.7772
[2020-09-09 01:06:16,048 INFO] Decaying learning rate to 7.5e-05
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_52.78_ppl_32.86_e5.pt
[2020-09-09 01:06:17,090 INFO] The current epoch: 6
[2020-09-09 01:06:32,765 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 01:06:42,749 INFO] Epoch  6,    50/  769; acc:  63.19; ppl:   6.13; xent:   1.81;  5271 src tok/s; 1004 tgt tok/s;     10 s elapsed
[2020-09-09 01:06:50,710 INFO] Epoch  6,   100/  769; acc:  63.89; ppl:   5.79; xent:   1.76;  7394 src tok/s; 1320 tgt tok/s;     18 s elapsed
[2020-09-09 01:06:58,295 INFO] Epoch  6,   150/  769; acc:  64.60; ppl:   5.59; xent:   1.72;  7413 src tok/s; 1384 tgt tok/s;     26 s elapsed
[2020-09-09 01:07:06,009 INFO] Epoch  6,   200/  769; acc:  64.50; ppl:   5.44; xent:   1.69;  7146 src tok/s; 1298 tgt tok/s;     33 s elapsed
[2020-09-09 01:07:14,970 INFO] Epoch  6,   250/  769; acc:  65.08; ppl:   5.16; xent:   1.64;  6192 src tok/s; 1134 tgt tok/s;     42 s elapsed
[2020-09-09 01:07:23,658 INFO] Epoch  6,   300/  769; acc:  66.54; ppl:   4.86; xent:   1.58;  6407 src tok/s; 1194 tgt tok/s;     51 s elapsed
[2020-09-09 01:07:32,163 INFO] Epoch  6,   350/  769; acc:  66.33; ppl:   4.98; xent:   1.61;  6125 src tok/s; 1204 tgt tok/s;     59 s elapsed
[2020-09-09 01:07:41,385 INFO] Epoch  6,   400/  769; acc:  67.83; ppl:   4.65; xent:   1.54;  6308 src tok/s; 1121 tgt tok/s;     69 s elapsed
[2020-09-09 01:07:50,856 INFO] Epoch  6,   450/  769; acc:  68.14; ppl:   4.35; xent:   1.47;  5737 src tok/s; 1087 tgt tok/s;     78 s elapsed
[2020-09-09 01:07:59,137 INFO] Epoch  6,   500/  769; acc:  68.47; ppl:   4.47; xent:   1.50;  6947 src tok/s; 1247 tgt tok/s;     86 s elapsed
[2020-09-09 01:08:08,124 INFO] Epoch  6,   550/  769; acc:  69.54; ppl:   4.06; xent:   1.40;  6544 src tok/s; 1145 tgt tok/s;     95 s elapsed
[2020-09-09 01:08:16,594 INFO] Epoch  6,   600/  769; acc:  68.38; ppl:   4.31; xent:   1.46;  6136 src tok/s; 1205 tgt tok/s;    104 s elapsed
[2020-09-09 01:08:25,358 INFO] Epoch  6,   650/  769; acc:  70.81; ppl:   3.85; xent:   1.35;  6088 src tok/s; 1223 tgt tok/s;    113 s elapsed
[2020-09-09 01:08:34,061 INFO] Epoch  6,   700/  769; acc:  70.08; ppl:   3.98; xent:   1.38;  6677 src tok/s; 1129 tgt tok/s;    121 s elapsed
[2020-09-09 01:08:42,962 INFO] Epoch  6,   750/  769; acc:  70.59; ppl:   3.89; xent:   1.36;  6182 src tok/s; 1139 tgt tok/s;    130 s elapsed
[2020-09-09 01:08:46,503 INFO] Train perplexity: 4.69575
[2020-09-09 01:08:46,504 INFO] Train accuracy: 67.2586
[2020-09-09 01:08:50,597 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 01:09:09,885 INFO] Validation perplexity: 33.0028
[2020-09-09 01:09:09,887 INFO] Validation accuracy: 52.7147
[2020-09-09 01:09:09,887 INFO] Decaying learning rate to 3.75e-05
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_52.71_ppl_33.00_e6.pt
[2020-09-09 01:09:10,772 INFO] The current epoch: 7
[2020-09-09 01:09:27,151 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 01:09:36,666 INFO] Epoch  7,    50/  769; acc:  64.16; ppl:   5.59; xent:   1.72;  5531 src tok/s; 1053 tgt tok/s;     10 s elapsed
[2020-09-09 01:09:45,116 INFO] Epoch  7,   100/  769; acc:  65.22; ppl:   5.29; xent:   1.67;  6966 src tok/s; 1244 tgt tok/s;     18 s elapsed
[2020-09-09 01:09:53,564 INFO] Epoch  7,   150/  769; acc:  65.57; ppl:   5.12; xent:   1.63;  6655 src tok/s; 1243 tgt tok/s;     26 s elapsed
[2020-09-09 01:10:01,894 INFO] Epoch  7,   200/  769; acc:  65.97; ppl:   4.97; xent:   1.60;  6617 src tok/s; 1202 tgt tok/s;     35 s elapsed
[2020-09-09 01:10:09,522 INFO] Epoch  7,   250/  769; acc:  66.22; ppl:   4.77; xent:   1.56;  7274 src tok/s; 1332 tgt tok/s;     42 s elapsed
[2020-09-09 01:10:17,215 INFO] Epoch  7,   300/  769; acc:  67.60; ppl:   4.50; xent:   1.50;  7234 src tok/s; 1348 tgt tok/s;     50 s elapsed
[2020-09-09 01:10:25,113 INFO] Epoch  7,   350/  769; acc:  66.88; ppl:   4.64; xent:   1.54;  6596 src tok/s; 1297 tgt tok/s;     58 s elapsed
[2020-09-09 01:10:34,474 INFO] Epoch  7,   400/  769; acc:  68.53; ppl:   4.33; xent:   1.47;  6214 src tok/s; 1104 tgt tok/s;     67 s elapsed
[2020-09-09 01:10:43,903 INFO] Epoch  7,   450/  769; acc:  68.89; ppl:   4.05; xent:   1.40;  5761 src tok/s; 1092 tgt tok/s;     77 s elapsed
[2020-09-09 01:10:54,284 INFO] Epoch  7,   500/  769; acc:  69.88; ppl:   4.11; xent:   1.41;  5542 src tok/s; 995 tgt tok/s;     87 s elapsed
[2020-09-09 01:11:04,361 INFO] Epoch  7,   550/  769; acc:  71.20; ppl:   3.71; xent:   1.31;  5837 src tok/s; 1022 tgt tok/s;     97 s elapsed
[2020-09-09 01:11:13,759 INFO] Epoch  7,   600/  769; acc:  70.17; ppl:   3.93; xent:   1.37;  5530 src tok/s; 1086 tgt tok/s;    107 s elapsed
[2020-09-09 01:11:23,283 INFO] Epoch  7,   650/  769; acc:  72.07; ppl:   3.56; xent:   1.27;  5601 src tok/s; 1125 tgt tok/s;    116 s elapsed
[2020-09-09 01:11:32,795 INFO] Epoch  7,   700/  769; acc:  71.28; ppl:   3.67; xent:   1.30;  6109 src tok/s; 1033 tgt tok/s;    126 s elapsed
[2020-09-09 01:11:42,604 INFO] Epoch  7,   750/  769; acc:  72.32; ppl:   3.57; xent:   1.27;  5609 src tok/s; 1034 tgt tok/s;    135 s elapsed
[2020-09-09 01:11:46,202 INFO] Train perplexity: 4.32344
[2020-09-09 01:11:46,203 INFO] Train accuracy: 68.4635
[2020-09-09 01:11:47,280 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 01:12:08,009 INFO] Validation perplexity: 33.2396
[2020-09-09 01:12:08,011 INFO] Validation accuracy: 52.7616
[2020-09-09 01:12:08,011 INFO] Decaying learning rate to 1.875e-05
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_52.76_ppl_33.24_e7.pt
[2020-09-09 01:12:08,858 INFO] The current epoch: 8
[2020-09-09 01:12:26,253 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 01:12:36,456 INFO] Epoch  8,    50/  769; acc:  64.80; ppl:   5.30; xent:   1.67;  5158 src tok/s; 982 tgt tok/s;     10 s elapsed
[2020-09-09 01:12:46,336 INFO] Epoch  8,   100/  769; acc:  65.94; ppl:   5.05; xent:   1.62;  5957 src tok/s; 1064 tgt tok/s;     20 s elapsed
[2020-09-09 01:12:55,766 INFO] Epoch  8,   150/  769; acc:  66.28; ppl:   4.88; xent:   1.59;  5964 src tok/s; 1114 tgt tok/s;     30 s elapsed
[2020-09-09 01:13:04,958 INFO] Epoch  8,   200/  769; acc:  66.52; ppl:   4.74; xent:   1.56;  5996 src tok/s; 1089 tgt tok/s;     39 s elapsed
[2020-09-09 01:13:13,453 INFO] Epoch  8,   250/  769; acc:  66.97; ppl:   4.53; xent:   1.51;  6531 src tok/s; 1196 tgt tok/s;     47 s elapsed
[2020-09-09 01:13:22,288 INFO] Epoch  8,   300/  769; acc:  68.32; ppl:   4.29; xent:   1.46;  6299 src tok/s; 1174 tgt tok/s;     56 s elapsed
[2020-09-09 01:13:31,353 INFO] Epoch  8,   350/  769; acc:  67.59; ppl:   4.44; xent:   1.49;  5747 src tok/s; 1130 tgt tok/s;     65 s elapsed
[2020-09-09 01:13:40,140 INFO] Epoch  8,   400/  769; acc:  69.01; ppl:   4.15; xent:   1.42;  6622 src tok/s; 1176 tgt tok/s;     74 s elapsed
[2020-09-09 01:13:47,956 INFO] Epoch  8,   450/  769; acc:  69.24; ppl:   3.88; xent:   1.36;  6951 src tok/s; 1317 tgt tok/s;     82 s elapsed
[2020-09-09 01:13:55,491 INFO] Epoch  8,   500/  769; acc:  70.31; ppl:   3.95; xent:   1.37;  7635 src tok/s; 1371 tgt tok/s;     89 s elapsed
[2020-09-09 01:14:03,325 INFO] Epoch  8,   550/  769; acc:  72.01; ppl:   3.54; xent:   1.27;  7508 src tok/s; 1314 tgt tok/s;     97 s elapsed
[2020-09-09 01:14:11,864 INFO] Epoch  8,   600/  769; acc:  71.10; ppl:   3.73; xent:   1.32;  6088 src tok/s; 1195 tgt tok/s;    106 s elapsed
[2020-09-09 01:14:20,886 INFO] Epoch  8,   650/  769; acc:  72.85; ppl:   3.39; xent:   1.22;  5913 src tok/s; 1188 tgt tok/s;    115 s elapsed
[2020-09-09 01:14:29,480 INFO] Epoch  8,   700/  769; acc:  72.46; ppl:   3.48; xent:   1.25;  6762 src tok/s; 1143 tgt tok/s;    123 s elapsed
[2020-09-09 01:14:38,676 INFO] Epoch  8,   750/  769; acc:  72.96; ppl:   3.44; xent:   1.24;  5983 src tok/s; 1103 tgt tok/s;    132 s elapsed
[2020-09-09 01:14:42,362 INFO] Train perplexity: 4.12871
[2020-09-09 01:14:42,363 INFO] Train accuracy: 69.1501
[2020-09-09 01:14:43,529 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 01:15:05,083 INFO] Validation perplexity: 33.513
[2020-09-09 01:15:05,085 INFO] Validation accuracy: 52.7355
[2020-09-09 01:15:05,085 INFO] Decaying learning rate to 9.375e-06
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_52.74_ppl_33.51_e8.pt
[2020-09-09 01:15:05,911 INFO] The current epoch: 9
[2020-09-09 01:15:19,982 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 01:15:30,302 INFO] Epoch  9,    50/  769; acc:  64.85; ppl:   5.21; xent:   1.65;  5100 src tok/s; 971 tgt tok/s;     10 s elapsed
[2020-09-09 01:15:40,125 INFO] Epoch  9,   100/  769; acc:  66.36; ppl:   4.92; xent:   1.59;  5992 src tok/s; 1070 tgt tok/s;     20 s elapsed
[2020-09-09 01:15:49,680 INFO] Epoch  9,   150/  769; acc:  66.59; ppl:   4.78; xent:   1.56;  5885 src tok/s; 1099 tgt tok/s;     30 s elapsed
[2020-09-09 01:15:59,137 INFO] Epoch  9,   200/  769; acc:  67.09; ppl:   4.60; xent:   1.53;  5828 src tok/s; 1059 tgt tok/s;     39 s elapsed
[2020-09-09 01:16:08,367 INFO] Epoch  9,   250/  769; acc:  67.92; ppl:   4.40; xent:   1.48;  6018 src tok/s; 1102 tgt tok/s;     48 s elapsed
[2020-09-09 01:16:18,068 INFO] Epoch  9,   300/  769; acc:  68.56; ppl:   4.17; xent:   1.43;  5737 src tok/s; 1069 tgt tok/s;     58 s elapsed
[2020-09-09 01:16:27,302 INFO] Epoch  9,   350/  769; acc:  68.25; ppl:   4.31; xent:   1.46;  5642 src tok/s; 1109 tgt tok/s;     67 s elapsed
[2020-09-09 01:16:36,883 INFO] Epoch  9,   400/  769; acc:  69.18; ppl:   4.03; xent:   1.39;  6071 src tok/s; 1079 tgt tok/s;     77 s elapsed
[2020-09-09 01:16:45,702 INFO] Epoch  9,   450/  769; acc:  69.64; ppl:   3.80; xent:   1.33;  6162 src tok/s; 1168 tgt tok/s;     86 s elapsed
[2020-09-09 01:16:54,386 INFO] Epoch  9,   500/  769; acc:  70.59; ppl:   3.88; xent:   1.36;  6625 src tok/s; 1189 tgt tok/s;     94 s elapsed
[2020-09-09 01:17:03,237 INFO] Epoch  9,   550/  769; acc:  72.30; ppl:   3.46; xent:   1.24;  6646 src tok/s; 1163 tgt tok/s;    103 s elapsed
[2020-09-09 01:17:11,187 INFO] Epoch  9,   600/  769; acc:  71.63; ppl:   3.63; xent:   1.29;  6540 src tok/s; 1284 tgt tok/s;    111 s elapsed
[2020-09-09 01:17:18,882 INFO] Epoch  9,   650/  769; acc:  73.53; ppl:   3.30; xent:   1.19;  6932 src tok/s; 1393 tgt tok/s;    119 s elapsed
[2020-09-09 01:17:26,644 INFO] Epoch  9,   700/  769; acc:  72.69; ppl:   3.39; xent:   1.22;  7485 src tok/s; 1266 tgt tok/s;    127 s elapsed
[2020-09-09 01:17:34,701 INFO] Epoch  9,   750/  769; acc:  73.51; ppl:   3.34; xent:   1.20;  6834 src tok/s; 1259 tgt tok/s;    135 s elapsed
[2020-09-09 01:17:38,617 INFO] Train perplexity: 4.02462
[2020-09-09 01:17:38,618 INFO] Train accuracy: 69.5684
[2020-09-09 01:17:42,860 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 01:18:04,468 INFO] Validation perplexity: 33.6129
[2020-09-09 01:18:04,470 INFO] Validation accuracy: 52.8033
[2020-09-09 01:18:04,470 INFO] Decaying learning rate to 4.6875e-06
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_52.80_ppl_33.61_e9.pt
[2020-09-09 01:18:05,399 INFO] The current epoch: 10
[2020-09-09 01:18:20,063 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 01:18:30,596 INFO] Epoch 10,    50/  769; acc:  64.98; ppl:   5.15; xent:   1.64;  4996 src tok/s; 951 tgt tok/s;     11 s elapsed
[2020-09-09 01:18:40,338 INFO] Epoch 10,   100/  769; acc:  66.65; ppl:   4.85; xent:   1.58;  6046 src tok/s; 1080 tgt tok/s;     20 s elapsed
[2020-09-09 01:18:49,268 INFO] Epoch 10,   150/  769; acc:  66.89; ppl:   4.71; xent:   1.55;  6296 src tok/s; 1176 tgt tok/s;     29 s elapsed
[2020-09-09 01:18:58,220 INFO] Epoch 10,   200/  769; acc:  66.86; ppl:   4.57; xent:   1.52;  6157 src tok/s; 1118 tgt tok/s;     38 s elapsed
[2020-09-09 01:19:07,082 INFO] Epoch 10,   250/  769; acc:  67.86; ppl:   4.31; xent:   1.46;  6262 src tok/s; 1146 tgt tok/s;     47 s elapsed
[2020-09-09 01:19:15,340 INFO] Epoch 10,   300/  769; acc:  69.29; ppl:   4.08; xent:   1.41;  6739 src tok/s; 1256 tgt tok/s;     55 s elapsed
[2020-09-09 01:19:24,013 INFO] Epoch 10,   350/  769; acc:  68.25; ppl:   4.26; xent:   1.45;  6006 src tok/s; 1181 tgt tok/s;     64 s elapsed
[2020-09-09 01:19:33,808 INFO] Epoch 10,   400/  769; acc:  69.87; ppl:   3.96; xent:   1.38;  5938 src tok/s; 1055 tgt tok/s;     74 s elapsed
[2020-09-09 01:19:42,853 INFO] Epoch 10,   450/  769; acc:  69.89; ppl:   3.74; xent:   1.32;  6007 src tok/s; 1138 tgt tok/s;     83 s elapsed
[2020-09-09 01:19:52,312 INFO] Epoch 10,   500/  769; acc:  70.90; ppl:   3.82; xent:   1.34;  6082 src tok/s; 1092 tgt tok/s;     92 s elapsed
[2020-09-09 01:20:02,377 INFO] Epoch 10,   550/  769; acc:  72.67; ppl:   3.42; xent:   1.23;  5843 src tok/s; 1023 tgt tok/s;    102 s elapsed
[2020-09-09 01:20:11,565 INFO] Epoch 10,   600/  769; acc:  71.48; ppl:   3.57; xent:   1.27;  5657 src tok/s; 1111 tgt tok/s;    111 s elapsed
[2020-09-09 01:20:20,662 INFO] Epoch 10,   650/  769; acc:  73.56; ppl:   3.26; xent:   1.18;  5864 src tok/s; 1178 tgt tok/s;    121 s elapsed
[2020-09-09 01:20:29,839 INFO] Epoch 10,   700/  769; acc:  73.26; ppl:   3.33; xent:   1.20;  6333 src tok/s; 1071 tgt tok/s;    130 s elapsed
[2020-09-09 01:20:39,088 INFO] Epoch 10,   750/  769; acc:  73.72; ppl:   3.30; xent:   1.20;  5950 src tok/s; 1097 tgt tok/s;    139 s elapsed
[2020-09-09 01:20:42,915 INFO] Train perplexity: 3.96763
[2020-09-09 01:20:42,916 INFO] Train accuracy: 69.7987
[2020-09-09 01:20:43,990 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 01:21:01,657 INFO] Validation perplexity: 33.6773
[2020-09-09 01:21:01,658 INFO] Validation accuracy: 52.7928
[2020-09-09 01:21:01,658 INFO] Decaying learning rate to 2.34375e-06
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_52.79_ppl_33.68_e10.pt
[2020-09-09 01:21:02,609 INFO] The current epoch: 11
[2020-09-09 01:21:20,787 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 01:21:30,337 INFO] Epoch 11,    50/  769; acc:  65.05; ppl:   5.10; xent:   1.63;  5511 src tok/s; 1049 tgt tok/s;     10 s elapsed
[2020-09-09 01:21:38,999 INFO] Epoch 11,   100/  769; acc:  66.36; ppl:   4.81; xent:   1.57;  6795 src tok/s; 1213 tgt tok/s;     18 s elapsed
[2020-09-09 01:21:48,602 INFO] Epoch 11,   150/  769; acc:  66.51; ppl:   4.71; xent:   1.55;  5855 src tok/s; 1094 tgt tok/s;     28 s elapsed
[2020-09-09 01:21:57,699 INFO] Epoch 11,   200/  769; acc:  67.12; ppl:   4.52; xent:   1.51;  6058 src tok/s; 1101 tgt tok/s;     37 s elapsed
[2020-09-09 01:22:07,086 INFO] Epoch 11,   250/  769; acc:  68.13; ppl:   4.27; xent:   1.45;  5912 src tok/s; 1082 tgt tok/s;     46 s elapsed
[2020-09-09 01:22:16,464 INFO] Epoch 11,   300/  769; acc:  69.37; ppl:   4.04; xent:   1.40;  5934 src tok/s; 1106 tgt tok/s;     56 s elapsed
[2020-09-09 01:22:25,751 INFO] Epoch 11,   350/  769; acc:  68.48; ppl:   4.21; xent:   1.44;  5609 src tok/s; 1103 tgt tok/s;     65 s elapsed
[2020-09-09 01:22:35,241 INFO] Epoch 11,   400/  769; acc:  69.77; ppl:   3.94; xent:   1.37;  6131 src tok/s; 1089 tgt tok/s;     74 s elapsed
[2020-09-09 01:22:44,582 INFO] Epoch 11,   450/  769; acc:  69.82; ppl:   3.71; xent:   1.31;  5816 src tok/s; 1102 tgt tok/s;     84 s elapsed
[2020-09-09 01:22:53,861 INFO] Epoch 11,   500/  769; acc:  71.02; ppl:   3.80; xent:   1.33;  6202 src tok/s; 1113 tgt tok/s;     93 s elapsed
[2020-09-09 01:23:03,479 INFO] Epoch 11,   550/  769; acc:  72.74; ppl:   3.40; xent:   1.22;  6115 src tok/s; 1070 tgt tok/s;    103 s elapsed
[2020-09-09 01:23:12,354 INFO] Epoch 11,   600/  769; acc:  71.80; ppl:   3.55; xent:   1.27;  5855 src tok/s; 1150 tgt tok/s;    112 s elapsed
[2020-09-09 01:23:22,169 INFO] Epoch 11,   650/  769; acc:  74.01; ppl:   3.23; xent:   1.17;  5435 src tok/s; 1092 tgt tok/s;    121 s elapsed
[2020-09-09 01:23:31,888 INFO] Epoch 11,   700/  769; acc:  73.23; ppl:   3.32; xent:   1.20;  5978 src tok/s; 1011 tgt tok/s;    131 s elapsed
[2020-09-09 01:23:40,964 INFO] Epoch 11,   750/  769; acc:  73.95; ppl:   3.27; xent:   1.19;  6062 src tok/s; 1117 tgt tok/s;    140 s elapsed
[2020-09-09 01:23:44,651 INFO] Train perplexity: 3.93858
[2020-09-09 01:23:44,652 INFO] Train accuracy: 69.8797
[2020-09-09 01:23:45,893 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 01:24:03,435 INFO] Validation perplexity: 33.7017
[2020-09-09 01:24:03,436 INFO] Validation accuracy: 52.798
[2020-09-09 01:24:03,436 INFO] Decaying learning rate to 1.17187e-06
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_52.80_ppl_33.70_e11.pt
[2020-09-09 01:24:04,390 INFO] The current epoch: 12
[2020-09-09 01:24:18,988 INFO] Loading train dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.train.1.pt, number of examples: 49211
[2020-09-09 01:24:27,467 INFO] Epoch 12,    50/  769; acc:  65.46; ppl:   5.07; xent:   1.62;  6208 src tok/s; 1182 tgt tok/s;      8 s elapsed
[2020-09-09 01:24:35,304 INFO] Epoch 12,   100/  769; acc:  66.44; ppl:   4.81; xent:   1.57;  7511 src tok/s; 1341 tgt tok/s;     16 s elapsed
[2020-09-09 01:24:43,811 INFO] Epoch 12,   150/  769; acc:  66.86; ppl:   4.65; xent:   1.54;  6609 src tok/s; 1234 tgt tok/s;     25 s elapsed
[2020-09-09 01:24:52,980 INFO] Epoch 12,   200/  769; acc:  67.28; ppl:   4.52; xent:   1.51;  6011 src tok/s; 1092 tgt tok/s;     34 s elapsed
[2020-09-09 01:25:02,508 INFO] Epoch 12,   250/  769; acc:  67.84; ppl:   4.28; xent:   1.45;  5824 src tok/s; 1066 tgt tok/s;     44 s elapsed
[2020-09-09 01:25:11,722 INFO] Epoch 12,   300/  769; acc:  69.22; ppl:   4.05; xent:   1.40;  6040 src tok/s; 1126 tgt tok/s;     53 s elapsed
[2020-09-09 01:25:20,396 INFO] Epoch 12,   350/  769; acc:  68.49; ppl:   4.19; xent:   1.43;  6005 src tok/s; 1181 tgt tok/s;     61 s elapsed
[2020-09-09 01:25:29,912 INFO] Epoch 12,   400/  769; acc:  70.04; ppl:   3.91; xent:   1.36;  6113 src tok/s; 1086 tgt tok/s;     71 s elapsed
[2020-09-09 01:25:39,195 INFO] Epoch 12,   450/  769; acc:  70.05; ppl:   3.71; xent:   1.31;  5852 src tok/s; 1109 tgt tok/s;     80 s elapsed
[2020-09-09 01:25:48,989 INFO] Epoch 12,   500/  769; acc:  70.89; ppl:   3.78; xent:   1.33;  5875 src tok/s; 1055 tgt tok/s;     90 s elapsed
[2020-09-09 01:25:58,294 INFO] Epoch 12,   550/  769; acc:  72.69; ppl:   3.39; xent:   1.22;  6320 src tok/s; 1106 tgt tok/s;     99 s elapsed
[2020-09-09 01:26:07,430 INFO] Epoch 12,   600/  769; acc:  72.21; ppl:   3.53; xent:   1.26;  5688 src tok/s; 1117 tgt tok/s;    108 s elapsed
[2020-09-09 01:26:16,128 INFO] Epoch 12,   650/  769; acc:  73.86; ppl:   3.23; xent:   1.17;  6133 src tok/s; 1232 tgt tok/s;    117 s elapsed
[2020-09-09 01:26:24,718 INFO] Epoch 12,   700/  769; acc:  73.69; ppl:   3.31; xent:   1.20;  6764 src tok/s; 1144 tgt tok/s;    126 s elapsed
[2020-09-09 01:26:33,959 INFO] Epoch 12,   750/  769; acc:  73.85; ppl:   3.26; xent:   1.18;  5955 src tok/s; 1098 tgt tok/s;    135 s elapsed
[2020-09-09 01:26:37,833 INFO] Train perplexity: 3.92557
[2020-09-09 01:26:37,833 INFO] Train accuracy: 69.9753
[2020-09-09 01:26:39,046 INFO] Loading valid dataset from ../new_processed_data/bm25/Twitter_src35_conv100_tgt10_vs30000_notshare.valid.1.pt, number of examples: 6024
[2020-09-09 01:27:00,636 INFO] Validation perplexity: 33.7142
[2020-09-09 01:27:00,637 INFO] Validation accuracy: 52.8189
[2020-09-09 01:27:00,637 INFO] Decaying learning rate to 5.85937e-07
Saving model into saved_models/bm25/Twitter_BiAttEncoder_0.0006_400rnn_300emb_seed23bm25_notshare_acc_52.82_ppl_33.71_e12.pt
[2020-09-09 01:27:01,587 INFO] Learning rate 5.85937e-07 is below 1e-6 at epoch 12. Stop training!!
